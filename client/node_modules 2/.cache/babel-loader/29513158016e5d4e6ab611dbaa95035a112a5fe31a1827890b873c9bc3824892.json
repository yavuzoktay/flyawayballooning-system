{"ast":null,"code":"import React,{useState,useEffect,useCallback}from\"react\";import{Link}from\"react-router-dom\";import NotesPopup from\"./NotesPopup\";import{Table,TableBody,TableCell,TableContainer,TableHead,TableRow,Paper}from\"@mui/material\";import axios from\"axios\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Notes=_ref=>{let{detail}=_ref;const[notes,setNotes]=useState([]);const[modal,setModal]=useState(false);// Fetch notes from the server\nconst fetchNotes=useCallback(async()=>{try{const response=await axios.get(\"/api/getAdminNotes?booking_id=\".concat(detail===null||detail===void 0?void 0:detail.booking_id));if(response.status===200){setNotes(response.data.notes||[]);}}catch(error){console.error(\"Error fetching notes:\",error);}},[detail===null||detail===void 0?void 0:detail.booking_id]);// Load notes on component mount\nuseEffect(()=>{fetchNotes();},[fetchNotes]);// Handle Modal\nconst handleModal=()=>{setModal(true);};const handleClose=()=>{setModal(false);};const handleAddNote=async(note,noteDate)=>{const booking_id=detail===null||detail===void 0?void 0:detail.booking_id;try{const response=await axios.post(\"/api/addAdminNotes\",{date:noteDate,booking_id,note});if(response.status===200){// Reload notes after successfully saving the new note\nawait fetchNotes();setModal(false);}else{alert(\"Failed to save note. Please try again.\");}}catch(error){console.error(\"Error saving note:\",error);alert(\"Failed to save note. Please try again.\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\"personal-detail-card notes-card-wrap\",style:{marginTop:\"20px\"},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Notes\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"main-notes-field\",children:[/*#__PURE__*/_jsx(Link,{onClick:handleModal,className:\"final-btn\",to:\"#\",children:\"+ Add Notes\"}),/*#__PURE__*/_jsx(NotesPopup,{modal:modal,handleClose:handleClose,onSave:handleAddNote}),notes.length>0?/*#__PURE__*/_jsx(TableContainer,{component:Paper,style:{marginTop:\"30px\"},children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"Date\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Note\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:notes.map((note,index)=>/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:new Date(note.date).toLocaleString()}),/*#__PURE__*/_jsx(TableCell,{children:note.notes})]},index))})]})}):/*#__PURE__*/_jsx(\"p\",{style:{marginTop:\"20px\"},children:\"No notes available.\"})]})]});};export default Notes;","map":{"version":3,"names":["React","useState","useEffect","useCallback","Link","NotesPopup","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","axios","jsx","_jsx","jsxs","_jsxs","Notes","_ref","detail","notes","setNotes","modal","setModal","fetchNotes","response","get","concat","booking_id","status","data","error","console","handleModal","handleClose","handleAddNote","note","noteDate","post","date","alert","className","style","marginTop","children","onClick","to","onSave","length","component","map","index","Date","toLocaleString"],"sources":["/Users/yavuzoktay/Documents/FlyAwayBallooning/flyawayballooning-system-backend/client/src/backend/components/ProfilePage/Notes.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport NotesPopup from \"./NotesPopup\";\nimport { Table, TableBody, TableCell, TableContainer, TableHead, TableRow, Paper } from \"@mui/material\";\nimport axios from \"axios\";\n\nconst Notes = ({ detail }) => {\n    const [notes, setNotes] = useState([]);\n    const [modal, setModal] = useState(false);\n\n    // Fetch notes from the server\n    const fetchNotes = useCallback(async () => {\n        try {\n            const response = await axios.get(`/api/getAdminNotes?booking_id=${detail?.booking_id}`);\n            if (response.status === 200) {\n                setNotes(response.data.notes || []);\n            }\n        } catch (error) {\n            console.error(\"Error fetching notes:\", error);\n        }\n    }, [detail?.booking_id]);\n\n    // Load notes on component mount\n    useEffect(() => {\n        fetchNotes();\n    }, [fetchNotes]);\n\n    // Handle Modal\n    const handleModal = () => {\n        setModal(true);\n    };\n\n    const handleClose = () => {\n        setModal(false);\n    };\n\n    const handleAddNote = async (note, noteDate) => {\n        const booking_id = detail?.booking_id;\n\n        try {\n            const response = await axios.post(\"/api/addAdminNotes\", {\n                date: noteDate,\n                booking_id,\n                note,\n            });\n\n            if (response.status === 200) {\n                // Reload notes after successfully saving the new note\n                await fetchNotes();\n                setModal(false);\n            } else {\n                alert(\"Failed to save note. Please try again.\");\n            }\n        } catch (error) {\n            console.error(\"Error saving note:\", error);\n            alert(\"Failed to save note. Please try again.\");\n        }\n    };\n\n    return (\n        <div className=\"personal-detail-card notes-card-wrap\" style={{ marginTop: \"20px\" }}>\n            <h2>Notes</h2>\n            <div className=\"main-notes-field\">\n                <Link onClick={handleModal} className=\"final-btn\" to=\"#\">\n                    + Add Notes\n                </Link>\n                <NotesPopup modal={modal} handleClose={handleClose} onSave={handleAddNote} />\n\n                {notes.length > 0 ? (\n                    <TableContainer component={Paper} style={{ marginTop: \"30px\" }}>\n                        <Table>\n                            <TableHead>\n                                <TableRow>\n                                    <TableCell>Date</TableCell>\n                                    <TableCell>Note</TableCell>\n                                </TableRow>\n                            </TableHead>\n                            <TableBody>\n                                {notes.map((note, index) => (\n                                    <TableRow key={index}>\n                                        <TableCell>{new Date(note.date).toLocaleString()}</TableCell>\n                                        <TableCell>{note.notes}</TableCell>\n                                    </TableRow>\n                                ))}\n                            </TableBody>\n                        </Table>\n                    </TableContainer>\n                ) : (\n                    <p style={{ marginTop: \"20px\" }}>No notes available.</p>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default Notes;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}